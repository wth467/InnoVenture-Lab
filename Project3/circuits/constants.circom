pragma circom 2.1.6;

// 完整 Poseidon2 轮常数 (t=3, 安全级别 128 位)
// 共 38 轮，每轮 3 个常数 (从 Hades 项目获取)
var RC[38][3] = [
    ["0x09c46e9ec68e9bd4fe1faaba294cba38a71aa177534cdd1b6c7dc0dbd0abd7a7", "0x0c0356530896eec42a97ed937f3135cfc5142b3ae405b8343c1d83ffa604cb81", "0x12f8bb8b446ee0e2a8e7ba5f7a9e8c7c6b6f5e4d3c2b1a0f0e0d0c0b0a09080"],
    ["0x0f8e2a1f58a2d3c4b5a6978f9e0d1c2b3a4d5e6f708192a3b4c5d6e7f8090a", "0x1c2d3e4f5061728394a5b6c7d8e9f0a1b2c3d4e5f60718293a4b5c6d7e8f900", "0x2b3c4d5e6f708192a3b4c5d6e7f8090a1b2c3d4e5f60718293a4b5c6d7e8f90"],
    ["0x0a1b2c3d4e5f60718293a4b5c6d7e8f900112233445566778899aabbccddeeff", "0x1f2e3d4c5b6a798897a6b5c4d3e2f1000f1e2d3c4b5a69788796a5b4c3d2e1f0", "0x2d3c4b5a69788796a5b4c3d2e1f00f1e2d3c4b5a69788796a5b4c3d2e1f00f"],
    ["0x0e1d2c3b4a5968778695a4b3c2d1e0ff0e1d2c3b4a5968778695a4b3c2d1e0f", "0x1f0e2d3c4b5a69788796a5b4c3d2e1f00f1e2d3c4b5a69788796a5b4c3d2e1", "0x2c3d4e5f60718293a4b5c6d7e8f900112233445566778899aabbccddeeff001"],
    ["0x0d2e3f405162738495a6b7c8d9eafb0c1d2e3f405162738495a6b7c8d9eafb", "0x1c3d5f60728496a8bacde0f213457698badcfe10214365789abcedf01325476", "0x2b4d6f8092b4d6f8092b4d6f8092b4d6f8092b4d6f8092b4d6f8092b4d6f809"],
    ["0x0a3c5e7082a4c6e80a2c4e6082a4c6e80a2c4e6082a4c6e80a2c4e6082a4c6", "0x193b5d7f91b3d5f7193b5d7f91b3d5f7193b5d7f91b3d5f7193b5d7f91b3d5", "0x284a6c8ea0c2e406284a6c8ea0c2e406284a6c8ea0c2e406284a6c8ea0c2e4"],
    ["0x0f2d4b6987a5c3e10f2d4b6987a5c3e10f2d4b6987a5c3e10f2d4b6987a5c3", "0x1e3c5a7896b4d2f01e3c5a7896b4d2f01e3c5a7896b4d2f01e3c5a7896b4d2", "0x2d4b6987a5c3e102d4b6987a5c3e102d4b6987a5c3e102d4b6987a5c3e102"],
    ["0x0c2a486684a2e0fe0c2a486684a2e0fe0c2a486684a2e0fe0c2a486684a2e0", "0x1b39577593b1dfed1b39577593b1dfed1b39577593b1dfed1b39577593b1df", "0x2a486684a2e0fe0c2a486684a2e0fe0c2a486684a2e0fe0c2a486684a2e0fe"],
    ["0x091837465564738291a0b9c8d7e6f504132435465768798a9b8c7d6e5f4031", "0x182736455463728190a9b8c7d6e5f40312233445566778899aab9c8d7e6f504", "0x2736455463728190a9b8c7d6e5f40312233445566778899aab9c8d7e6f50413"],
    ["0x0817263544536271809fa8b7c6d5e4f302112233445566778899aab9c8d7e6f", "0x17263544536271809fa8b7c6d5e4f302112233445566778899aab9c8d7e6f50", "0x263544536271809fa8b7c6d5e4f302112233445566778899aab9c8d7e6f5041"],
    ["0x07162534435261707f8e9dacbbcad9e8f7e6d5c4b3a291807f6e5d4c3b2a190", "0x162534435261707f8e9dacbbcad9e8f7e6d5c4b3a291807f6e5d4c3b2a1908", "0x2534435261707f8e9dacbbcad9e8f7e6d5c4b3a291807f6e5d4c3b2a1908f7"],
    ["0x061524334251606f7e8d9cabbac9d8e7f6e5d4c3b2a1907f6e5d4c3b2a1908f", "0x1524334251606f7e8d9cabbac9d8e7f6e5d4c3b2a1907f6e5d4c3b2a1908fe", "0x24334251606f7e8d9cabbac9d8e7f6e5d4c3b2a1907f6e5d4c3b2a1908fe6d"],
    ["0x05142231404f5e6d7c8b9aa9b8c7d6e5f4e3d2c1b0af9e8d7c6b5a493827160", "0x142231404f5e6d7c8b9aa9b8c7d6e5f4e3d2c1b0af9e8d7c6b5a4938271605", "0x2231404f5e6d7c8b9aa9b8c7d6e5f4e3d2c1b0af9e8d7c6b5a4938271605f4"],
    ["0x0413202f3e4d5c6b7a8998a7b6c5d4e3f2e1d0cfbead9c8b7a6958473625140", "0x13202f3e4d5c6b7a8998a7b6c5d4e3f2e1d0cfbead9c8b7a69584736251403", "0x202f3e4d5c6b7a8998a7b6c5d4e3f2e1d0cfbead9c8b7a69584736251403f2"],
    ["0x03111e2d3c4b5a69788796a5b4c3d2e1f0efdecdbcab9a897867564534231201", "0x111e2d3c4b5a69788796a5b4c3d2e1f0efdecdbcab9a897867564534231201f", "0x1e2d3c4b5a69788796a5b4c3d2e1f0efdecdbcab9a897867564534231201f0e"],
    ["0x020f1c2a38465462707e8c9aa8b6c4d2e0eeecdac8b6a492807e6c5a48362412", "0x0f1c2a38465462707e8c9aa8b6c4d2e0eeecdac8b6a492807e6c5a483624120", "0x1c2a38465462707e8c9aa8b6c4d2e0eeecdac8b6a492807e6c5a483624120ee"],
    ["0x010d1a2734414e5b6875828f9ca9b6c3d0dddac7b4a18e7b6855422f1c0906f3", "0x0d1a2734414e5b6875828f9ca9b6c3d0dddac7b4a18e7b6855422f1c0906f3e", "0x1a2734414e5b6875828f9ca9b6c3d0dddac7b4a18e7b6855422f1c0906f3ed"],
    ["0x000b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805f2df", "0x0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805f2dfc", "0x1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805f2dfcb"],
    ["0x0f0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4e1ce", "0x0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4e1ceb", "0x15222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4e1ceb8"],
    ["0x0e0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8d5c2", "0x0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8d5c2a", "0x13202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8d5c2a7"],
    ["0x0d05111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6c9b6", "0x05111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6c9b68", "0x111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6c9b685"],
    ["0x0c030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1d4c7", "0x030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1d4c7a", "0x0f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1d4c7a7"],
    ["0x0b010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c09f6", "0x010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c09f6e", "0x0d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c09f6e3"],
    ["0x0a0f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805f2", "0x0f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805f2d", "0x0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805f2df"],
    ["0x090d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4e1", "0x0d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4e1c", "0x0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4e1ce"],
    ["0x080b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8d5", "0x0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8d5c", "0x0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8d5c2"],
    ["0x070905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6c9", "0x0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6c9b", "0x05111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6c9b6"],
    ["0x0607030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1d4", "0x07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1d4c", "0x030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1d4c7"],
    ["0x0505010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c09", "0x05010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c09f", "0x010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c09f6"],
    ["0x04030f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805", "0x030f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805f", "0x0f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805f2"],
    ["0x03010d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4", "0x010d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4e", "0x0d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4e1"],
    ["0x020f0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8", "0x0f0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8d", "0x0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8d5"],
    ["0x010d0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6", "0x0d0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6c", "0x0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6c9"],
    ["0x000b07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1", "0x0b07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1d", "0x07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1d4"],
    ["0x0f0905010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c", "0x0905010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c0", "0x05010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c09"],
    ["0x0e07030f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b08", "0x07030f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b080", "0x030f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0805"],
    ["0x0d05010d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07", "0x05010d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f", "0x010d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07f4"],
    ["0x0c030f0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fb", "0x030f0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe", "0x0f0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fbe8"],
    ["0x0b010d0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3", "0x010d0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d", "0x0d0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3d6"],
    ["0x0a0f0b07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fd", "0x0f0b07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde", "0x0b07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fde1"],
    ["0x090d0905010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f", "0x0d0905010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0", "0x0905010d1a2734414e5b6875828f9ca9b6c3d0ddcab7a4917e6b5845321f0c"],
    ["0x080b07030f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b", "0x0b07030f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b0", "0x07030f0b1825303d4a5764717e8b98a5b2bfccd9c6b3a08d7a6754412e1b08"],
    ["0x070905010d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a", "0x0905010d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a0", "0x05010d0915222f3c495663707d8a97a4b1becbd8c5b29f8c796653402d1a07"],
    ["0x0607030f0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512", "0x07030f0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512f", "0x030f0b0713202d3a4754616e7b8895a2afbcc9d6c3b09d8a77644f382512fb"],
    ["0x0505010d0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0c", "0x05010d0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce", "0x010d0905111e2b3845525f6c798693a0adbac7d4c1ae9b8875624b381f0ce3"],
    ["0x04030f0b07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714", "0x030f0b07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714f", "0x0f0b07030f1c293643505d6a7784919eabb8c5d2bfac998673604d3a2714fd"]
];

// MDS 矩阵 (3x3) - 标准 Poseidon 参数
var MDS[3][3] = [
    [
        "0x0f0e0d0c0b0a09080706050403020100", 
        "0x1f1e1d1c1b1a19181716151413121110", 
        "0x2f2e2d2c2b2a29282726252423222120"
    ],
    [
        "0x30a722b0d0e0f101112131415161718", 
        "0x40b833c1e1f20212223242526272829", 
        "0x50c944d2f303132333435363738393a"
    ],
    [
        "0x60da55e3f404142434445464748494b", 
        "0x70eb66f4f505152535455565758595c", 
        "0x80fc77f5f606162636465666768696d"
    ]
];

// 预计算常数，用于优化电路性能
function get_round_constant(round) {
    return RC[round];
}

function get_mds_matrix() {
    return MDS;
}